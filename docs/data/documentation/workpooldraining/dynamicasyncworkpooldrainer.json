{"primaryContentSections":[{"kind":"declarations","declarations":[{"languages":["swift"],"tokens":[{"kind":"keyword","text":"final"},{"kind":"text","text":" "},{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"DynamicAsyncWorkPoolDrainer"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"T"},{"kind":"text","text":"> "},{"kind":"keyword","text":"where"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":" : "},{"preciseIdentifier":"s:s8SendableP","kind":"typeIdentifier","text":"Sendable"}],"platforms":["macOS"]}]},{"content":[{"type":"heading","anchor":"overview","level":2,"text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In some cases, we need execute many heavy tasks and we want limit number of simultaneous executions"},{"type":"text","text":" "},{"type":"codeVoice","code":"TaskGroup"},{"type":"text","text":" execute all given tasks simultaneously, so it is not suitable for this scenario"}]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"DynamicAsyncWorkPoolDrainer"},{"text":" allow to add work dynamically. Even if atm it was drained, you still can add more work and iterate later over all resutls.","type":"text"},{"text":" ","type":"text"},{"text":"But if at least one task failed, draining was cancelled or intake closed - no new work will be added","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If drain will be cancelled, it will throw "},{"code":"WorkPoolDrainerError.cancelled","type":"codeVoice"},{"type":"text","text":" in iterator. This happens even if all current tasks completed"}]},{"type":"paragraph","inlineContent":[{"text":"Usage:","type":"text"}]},{"type":"codeListing","code":["let pool = DynamicAsyncWorkPoolDrainer<Int>(maxConcurrentOperationCount: 5)","for i in 0..<1024 {","    pool.add { \/* some heavy task *\/ }","}","pool.closeIntake()","","for try await i in pool {","  \/\/ process result","}"],"syntax":"swift"},{"type":"aside","style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Order of iteration might be different from order of added work, because each process might take different amount of time and we prefer to provide result ASAP"}]}],"name":"Note"}],"kind":"content"}],"identifier":{"url":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer","interfaceLanguage":"swift"},"sections":[],"schemaVersion":{"major":0,"patch":0,"minor":3},"topicSections":[{"generated":true,"anchor":"Initializers","identifiers":["doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/init(maxConcurrentOperationCount:resultsOrder:)"],"title":"Initializers"},{"generated":true,"anchor":"Instance-Methods","identifiers":["doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/add(_:)","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/addMany(_:)","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/cancel()","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/closeIntake()","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/makeAsyncIterator()"],"title":"Instance Methods"},{"generated":true,"anchor":"Type-Aliases","identifiers":["doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/AsyncIterator","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/Element","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/Work"],"title":"Type Aliases"},{"generated":true,"anchor":"Default-Implementations","identifiers":["doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/AsyncSequence-Implementations","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/AsyncSequence-Implementations","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/WorkPoolDrainer-Implementations"],"title":"Default Implementations"}],"relationshipsSections":[{"kind":"relationships","identifiers":["doc:\/\/drain-work-pool.WorkPoolDraining\/s8SendableP","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/WorkPoolDrainer","doc:\/\/drain-work-pool.WorkPoolDraining\/Sci"],"type":"conformsTo","title":"Conforms To"}],"seeAlsoSections":[{"generated":true,"anchor":"Work-Pool-Drainers","identifiers":["doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/StaticAsyncWorkPoolDrainer","doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/StaticSyncWorkPoolDrainer"],"title":"Work Pool Drainers"}],"kind":"symbol","variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer"]}],"metadata":{"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"DynamicAsyncWorkPoolDrainer"}],"modules":[{"name":"WorkPoolDraining"}],"title":"DynamicAsyncWorkPoolDrainer","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"DynamicAsyncWorkPoolDrainer"}],"externalID":"s:16WorkPoolDraining012DynamicAsyncaB7DrainerC","symbolKind":"class","roleHeading":"Class"},"abstract":[{"type":"text","text":"Drain dynamically sized pool of work, limiting number of simultaneous executions"}],"hierarchy":{"paths":[["doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining"]]},"references":{"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/AsyncSequence-Implementations":{"identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/AsyncSequence-Implementations","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/asyncsequence-implementations","title":"AsyncSequence Implementations","kind":"article","role":"collectionGroup","abstract":[],"type":"topic"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/WorkPoolDrainer-Implementations":{"abstract":[],"url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/workpooldrainer-implementations","kind":"article","title":"WorkPoolDrainer Implementations","type":"topic","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/WorkPoolDrainer-Implementations","role":"collectionGroup"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/makeAsyncIterator()":{"type":"topic","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/makeasynciterator()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"makeAsyncIterator"},{"kind":"text","text":"() -> "},{"kind":"typeIdentifier","text":"AsyncIterator","preciseIdentifier":"s:16WorkPoolDraining012DynamicAsyncaB7DrainerC0E8Iteratora"}],"kind":"symbol","title":"makeAsyncIterator()","role":"symbol","abstract":[],"identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/makeAsyncIterator()"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/AsyncIterator":{"type":"topic","kind":"symbol","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/AsyncIterator","role":"symbol","fragments":[{"kind":"keyword","text":"typealias"},{"kind":"text","text":" "},{"kind":"identifier","text":"AsyncIterator"}],"navigatorTitle":[{"kind":"identifier","text":"AsyncIterator"}],"title":"DynamicAsyncWorkPoolDrainer.AsyncIterator","abstract":[],"url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/asynciterator"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/cancel()":{"role":"symbol","kind":"symbol","abstract":[{"text":"Destructive action, it will prevent any future work and stop all iteration with error.","type":"text"},{"text":" ","type":"text"},{"text":"Any future iteration will fail immediately..","type":"text"}],"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"cancel"},{"kind":"text","text":"()"}],"title":"cancel()","type":"topic","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/cancel()","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/cancel()"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/WorkPoolDrainer":{"url":"\/documentation\/workpooldraining\/workpooldrainer","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/WorkPoolDrainer","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"WorkPoolDrainer","kind":"identifier"}],"title":"WorkPoolDrainer","kind":"symbol","navigatorTitle":[{"text":"WorkPoolDrainer","kind":"identifier"}],"abstract":[],"role":"symbol","type":"topic"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer":{"type":"topic","kind":"symbol","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"DynamicAsyncWorkPoolDrainer"}],"navigatorTitle":[{"kind":"identifier","text":"DynamicAsyncWorkPoolDrainer"}],"role":"symbol","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer","abstract":[{"type":"text","text":"Drain dynamically sized pool of work, limiting number of simultaneous executions"}],"title":"DynamicAsyncWorkPoolDrainer"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/init(maxConcurrentOperationCount:resultsOrder:)":{"fragments":[{"text":"init","kind":"identifier"},{"text":"(","kind":"text"},{"text":"maxConcurrentOperationCount","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Int","kind":"typeIdentifier","preciseIdentifier":"s:Si"},{"text":", ","kind":"text"},{"text":"resultsOrder","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"OrderMode","kind":"typeIdentifier","preciseIdentifier":"s:16WorkPoolDraining9OrderModeO"},{"text":")","kind":"text"}],"title":"init(maxConcurrentOperationCount:resultsOrder:)","abstract":[],"identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/init(maxConcurrentOperationCount:resultsOrder:)","role":"symbol","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/init(maxconcurrentoperationcount:resultsorder:)","kind":"symbol","type":"topic"},"doc://drain-work-pool.WorkPoolDraining/Sci":{"identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/Sci","type":"unresolvable","title":"_Concurrency.AsyncSequence"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining":{"url":"\/documentation\/workpooldraining","abstract":[{"text":"This package aims to help with execution of a large number of tasks while limiting the number of simultaneously executed tasks.","type":"text"}],"type":"topic","kind":"symbol","title":"WorkPoolDraining","role":"collection","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/StaticSyncWorkPoolDrainer":{"fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"StaticSyncWorkPoolDrainer","kind":"identifier"}],"url":"\/documentation\/workpooldraining\/staticsyncworkpooldrainer","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/StaticSyncWorkPoolDrainer","title":"StaticSyncWorkPoolDrainer","role":"symbol","type":"topic","abstract":[{"type":"text","text":"Executed sync process block on predefined stack of elements, limiting number of simultaneous executions"}],"navigatorTitle":[{"text":"StaticSyncWorkPoolDrainer","kind":"identifier"}],"kind":"symbol"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/add(_:)":{"abstract":[],"url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/add(_:)","role":"symbol","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/add(_:)","title":"add(_:)","type":"topic","kind":"symbol","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"add"},{"kind":"text","text":"("},{"kind":"typeIdentifier","preciseIdentifier":"s:16WorkPoolDraining012DynamicAsyncaB7DrainerC0A0a","text":"Work"},{"kind":"text","text":")"}]},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/closeIntake()":{"role":"symbol","abstract":[],"identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/closeIntake()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"closeIntake"},{"kind":"text","text":"()"}],"title":"closeIntake()","kind":"symbol","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/closeintake()","type":"topic"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/Element":{"navigatorTitle":[{"text":"Element","kind":"identifier"}],"fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Element","kind":"identifier"}],"title":"DynamicAsyncWorkPoolDrainer.Element","type":"topic","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/element","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/Element","kind":"symbol","role":"symbol","abstract":[]},"doc://drain-work-pool.WorkPoolDraining/s8SendableP":{"type":"unresolvable","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/s8SendableP","title":"Swift.Sendable"},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/Work":{"role":"symbol","url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/work","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/Work","type":"topic","title":"DynamicAsyncWorkPoolDrainer.Work","fragments":[{"kind":"keyword","text":"typealias"},{"kind":"text","text":" "},{"kind":"identifier","text":"Work"}],"kind":"symbol","abstract":[],"navigatorTitle":[{"kind":"identifier","text":"Work"}]},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/StaticAsyncWorkPoolDrainer":{"navigatorTitle":[{"kind":"identifier","text":"StaticAsyncWorkPoolDrainer"}],"role":"symbol","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/StaticAsyncWorkPoolDrainer","title":"StaticAsyncWorkPoolDrainer","kind":"symbol","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"StaticAsyncWorkPoolDrainer"}],"type":"topic","url":"\/documentation\/workpooldraining\/staticasyncworkpooldrainer","abstract":[{"type":"text","text":"Executed async process block on predefined stack of elements, limiting number of simultaneous executions"}]},"doc://drain-work-pool.WorkPoolDraining/documentation/WorkPoolDraining/DynamicAsyncWorkPoolDrainer/addMany(_:)":{"type":"topic","title":"addMany(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"addMany"},{"kind":"text","text":"(["},{"kind":"typeIdentifier","preciseIdentifier":"s:16WorkPoolDraining012DynamicAsyncaB7DrainerC0A0a","text":"Work"},{"kind":"text","text":"])"}],"kind":"symbol","role":"symbol","identifier":"doc:\/\/drain-work-pool.WorkPoolDraining\/documentation\/WorkPoolDraining\/DynamicAsyncWorkPoolDrainer\/addMany(_:)","abstract":[],"url":"\/documentation\/workpooldraining\/dynamicasyncworkpooldrainer\/addmany(_:)"}}}